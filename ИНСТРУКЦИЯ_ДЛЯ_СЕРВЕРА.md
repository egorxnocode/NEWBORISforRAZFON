# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ

## –°–µ—Ä–≤–µ—Ä: 91.229.90.221

---

## ‚ö° –ë–´–°–¢–†–û–ï –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï (2 –∫–æ–º–∞–Ω–¥—ã)

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@91.229.90.221
```

–ü–∞—Ä–æ–ª—å: `44VoWOy4f0&j`

### –®–∞–≥ 2: –°–∫–∞—á–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç

```bash
curl -sL https://raw.githubusercontent.com/egorxnocode/NEWBORISforRAZFON/main/deploy-to-server.sh | bash
```

–ò–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ:

```bash
cd /tmp
wget https://raw.githubusercontent.com/egorxnocode/NEWBORISforRAZFON/main/deploy-to-server.sh
chmod +x deploy-to-server.sh
./deploy-to-server.sh
```

---

## üîß –ß–¢–û –î–ï–õ–ê–ï–¢ –°–ö–†–ò–ü–¢ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò:

‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Docker  
‚úÖ –ù–∞—Ö–æ–¥–∏—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã n8n –∏ Supabase  
‚úÖ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç Docker —Å–µ—Ç—å  
‚úÖ –ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ `/opt/NEWBORISforRAZFON`  
‚úÖ –°–æ–∑–¥–∞–µ—Ç `.env` —Ñ–∞–π–ª (—à–∞–±–ª–æ–Ω)  
‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç docker-compose –¥–ª—è –≤–∞—à–µ–π —Å–µ—Ç–∏  
‚úÖ –°–æ–∑–¥–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤  
‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ—Ä—Ç—ã (–µ—Å–ª–∏ 8080 –∑–∞–Ω—è—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 8081)  

---

## ‚öôÔ∏è –ü–û–°–õ–ï –ó–ê–ü–£–°–ö–ê –°–ö–†–ò–ü–¢–ê:

### 1Ô∏è‚É£ –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env

```bash
nano /opt/NEWBORISforRAZFON/.env
```

**–ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:**

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather

# –≠—Ç–æ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å (–∏–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ Docker)
SUPABASE_URL=http://supabase:8000
SUPABASE_KEY=–≤–∞—à_service_role_–∫–ª—é—á

N8N_WEBHOOK_URL=http://n8n:5678/webhook/generate-post

ADMIN_IDS=–≤–∞—à_telegram_id
COURSE_CHAT_ID=-1001234567890
MONITORING_CHAT_ID=-1001234567891
OPENAI_API_KEY=sk-–≤–∞—à_–∫–ª—é—á
TIMEZONE=Europe/Moscow
```

**–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ:** `Ctrl+O`, `Enter`, `Ctrl+X`

### 2Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∏—Ç–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã

–° –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (Mac):

```bash
scp -r "/Users/upsk/Documents/NEW BORIS/media"/* root@91.229.90.221:/opt/NEWBORISforRAZFON/media/
```

–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd /opt/NEWBORISforRAZFON/media
# –ó–∞–≥—Ä—É–∑–∏—Ç–µ —á–µ—Ä–µ–∑ wget, curl –∏–ª–∏ FileZilla
```

**–ù—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã:**
```
media/
‚îú‚îÄ‚îÄ welcome_video.mp4
‚îú‚îÄ‚îÄ channel_request.jpg
‚îú‚îÄ‚îÄ final_message.jpg
‚îú‚îÄ‚îÄ instruction.mp4
‚îú‚îÄ‚îÄ tasks/task_1.jpg ... task_14.jpg
‚îú‚îÄ‚îÄ penalties/penalty.jpg
‚îî‚îÄ‚îÄ reminders/reminder_1.jpg, reminder_2.jpg, reminder_3.jpg
```

### 3Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
cd /opt/NEWBORISforRAZFON
docker-compose -f docker-compose.production.yml up -d --build
```

### 4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
docker logs -f telegram-bot
```

**–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:**
```
–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω!
–í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞: Europe/Moscow
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã: [–≤–∞—à_id]
–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—â–µ–Ω!
```

---

## üîç –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

```bash
docker ps
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
- n8n
- supabase
- telegram-bot

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç—å

```bash
docker network inspect –∏–º—è-—Å–µ—Ç–∏ | grep telegram-bot
```

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤—è–∑—å

```bash
# –ë–æ—Ç –≤–∏–¥–∏—Ç Supabase?
docker exec telegram-bot ping -c 2 supabase

# –ë–æ—Ç –≤–∏–¥–∏—Ç n8n?
docker exec telegram-bot ping -c 2 n8n
```

---

## üõ†Ô∏è –£–ü–†–ê–í–õ–ï–ù–ò–ï –ë–û–¢–û–ú

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
docker stop telegram-bot

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
docker start telegram-bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker restart telegram-bot

# –£–¥–∞–ª–∏—Ç—å (—Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π)
docker-compose -f docker-compose.production.yml down
docker-compose -f docker-compose.production.yml up -d --build

# –õ–æ–≥–∏
docker logs -f telegram-bot

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
docker logs --tail=100 telegram-bot

# –ó–∞–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker exec -it telegram-bot bash
```

---

## üîÑ –û–ë–ù–û–í–õ–ï–ù–ò–ï –ë–û–¢–ê

```bash
cd /opt/NEWBORISforRAZFON
git pull
docker-compose -f docker-compose.production.yml up -d --build
docker logs -f telegram-bot
```

---

## üìä –ù–ê–°–¢–†–û–ô–ö–ê SUPABASE

### 1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç—ã

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ Supabase:

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ GitHub –∏–ª–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
cat /opt/NEWBORISforRAZFON/setup_database.sql
cat /opt/NEWBORISforRAZFON/setup_course_database.sql
```

### 2. –î–æ–±–∞–≤—å—Ç–µ email'—ã

–í —Ç–∞–±–ª–∏—Ü–µ `users` –¥–æ–±–∞–≤—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ email'—ã:

```sql
INSERT INTO users (email) VALUES ('user1@example.com');
INSERT INTO users (email) VALUES ('user2@example.com');
```

### 3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏—è

–í —Ç–∞–±–ª–∏—Ü–∞—Ö `digest_day_1` ... `digest_day_14` –¥–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–∞–Ω–∏—è.

---

## üêõ TROUBLESHOOTING

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker logs telegram-bot

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env
cat /opt/NEWBORISforRAZFON/.env

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã
docker ps
netstat -tulpn | grep 8080
```

### –û—à–∏–±–∫–∞: Cannot resolve host 'supabase'

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç—å
docker network inspect –∏–º—è-—Å–µ—Ç–∏

# –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ —Å–µ—Ç—å –≤—Ä—É—á–Ω—É—é
docker network connect –∏–º—è-—Å–µ—Ç–∏ telegram-bot
```

### –û—à–∏–±–∫–∞: Port 8080 already in use

**–†–µ—à–µ–Ω–∏–µ:** –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω–∏—Ç –Ω–∞ 8081

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
nano docker-compose.production.yml
# –ò–∑–º–µ–Ω–∏—Ç–µ "8080:8080" –Ω–∞ "8081:8080"
```

### –ë–æ—Ç –Ω–µ –≤–∏–¥–∏—Ç n8n –∏–ª–∏ Supabase

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps --format 'table {{.Names}}\t{{.Ports}}'

# –û–±–Ω–æ–≤–∏—Ç–µ .env —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏
nano /opt/NEWBORISforRAZFON/.env
```

---

## üéØ –ß–ï–ö–õ–ò–°–¢

- [ ] –ü–æ–¥–∫–ª—é—á–∏–ª—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
- [ ] –ó–∞–ø—É—Å—Ç–∏–ª —Å–∫—Ä–∏–ø—Ç deploy-to-server.sh
- [ ] –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª .env
- [ ] –ó–∞–≥—Ä—É–∑–∏–ª –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã
- [ ] –ó–∞–ø—É—Å—Ç–∏–ª docker-compose
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –ª–æ–≥–∏ (–Ω–µ—Ç –æ—à–∏–±–æ–∫)
- [ ] –í—ã–ø–æ–ª–Ω–∏–ª SQL –≤ Supabase
- [ ] –î–æ–±–∞–≤–∏–ª email'—ã –≤ users
- [ ] –ó–∞–ø–æ–ª–Ω–∏–ª –∑–∞–¥–∞–Ω–∏—è –≤ digest_day_X
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –±–æ—Ç–∞ –≤ Telegram (/start)

---

## üìû –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker ps -a

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Å–µ—Ç–∏
docker network ls

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker inspect telegram-bot

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats telegram-bot

# –û—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤
docker system prune -a
```

---

**–ì–æ—Ç–æ–≤–æ! –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! üöÄ**

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã, —Å–º–æ—Ç—Ä–∏—Ç–µ:
- DOCKER_DEPLOY.md
- DOCKER_QUICK_START.md
- –ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢.txt

