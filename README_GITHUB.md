# ü§ñ Telegram Bot - Course Management System

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ–º "–†–∞–∑–≥–æ–Ω" —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏, —Å–∏—Å—Ç–µ–º–æ–π —à—Ç—Ä–∞—Ñ–æ–≤ –∏ AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –ø–æ—Å—Ç–æ–≤.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π email
- ‚úÖ 14-–¥–Ω–µ–≤–Ω—ã–π –∫—É—Ä—Å —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏
- ‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (8:50, 9:20, 9:35)
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —à—Ç—Ä–∞—Ñ–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ —á–∞—Ç–∞
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ AI (n8n + OpenAI)
- ‚úÖ –ì–æ–ª–æ—Å–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã (—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —á–µ—Ä–µ–∑ Whisper)
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
- ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–¥–º–∏–Ω–æ–≤

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ bot.py                       # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îú‚îÄ‚îÄ course.py                    # –õ–æ–≥–∏–∫–∞ –∫—É—Ä—Å–∞
‚îú‚îÄ‚îÄ database.py                  # –†–∞–±–æ—Ç–∞ —Å Supabase
‚îú‚îÄ‚îÄ config.py                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ messages.py                  # –í—Å–µ —Ç–µ–∫—Å—Ç—ã –±–æ—Ç–∞
‚îú‚îÄ‚îÄ monitoring.py                # –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îú‚îÄ‚îÄ monitoring_messages.py       # –¢–µ–∫—Å—Ç—ã –æ—Ç—á–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ post_handlers.py             # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ post_validator.py            # –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫
‚îú‚îÄ‚îÄ ai_helper.py                 # OpenAI + n8n
‚îú‚îÄ‚îÄ user_states.py               # –°–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ webhook_server.py            # Webhook –¥–ª—è n8n
‚îú‚îÄ‚îÄ requirements.txt             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ setup_database.sql           # SQL: –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
‚îú‚îÄ‚îÄ setup_course_database.sql    # SQL: —Ç–∞–±–ª–∏—Ü—ã –∫—É—Ä—Å–∞
‚îî‚îÄ‚îÄ media/                       # –ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã
```

## üîß –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/YOUR_USERNAME/YOUR_REPO.git
cd YOUR_REPO
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
python3 -m venv venv
source venv/bin/activate  # –ù–∞ Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `ENV_EXAMPLE.txt`:

```env
BOT_TOKEN=your_bot_token
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your_key
ADMIN_IDS=123456789
COURSE_CHAT_ID=-1001234567890
MONITORING_CHAT_ID=-1001234567891
OPENAI_API_KEY=sk-your_key
N8N_WEBHOOK_URL=https://your-n8n.com/webhook
```

### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Supabase

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL-—Å–∫—Ä–∏–ø—Ç—ã:
1. `setup_database.sql` - —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É users
2. `setup_course_database.sql` - —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã –∫—É—Ä—Å–∞ (digest_day_1 ... digest_day_14)

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `digest_day_X`.

### 5. –î–æ–±–∞–≤—å—Ç–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã

–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ –ø–∞–ø–∫—É `media/`:
- `welcome_video.mp4`
- `channel_request.jpg`
- `final_message.jpg`
- `instruction.mp4`
- `tasks/task_1.jpg ... task_14.jpg`
- `penalties/penalty.jpg`
- `reminders/reminder_1.jpg, reminder_2.jpg, reminder_3.jpg`

### 6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
python bot.py
```

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢.txt** - –±—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–†—É—Å—Å–∫–∏–π)
- **–ò–ù–°–¢–†–£–ö–¶–ò–Ø.md** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (–†—É—Å—Å–∫–∏–π)
- **–ú–û–ù–ò–¢–û–†–ò–ù–ì.md** - —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **N8N_SETUP.md** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ n8n –¥–ª—è AI

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

```
/razgon_start          - –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫—É—Ä—Å (–∞–¥–º–∏–Ω)
/send_digest all       - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –≤—Å–µ–º (–∞–¥–º–∏–Ω)
/send_digest <id>      - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –æ–¥–Ω–æ–º—É (–∞–¥–º–∏–Ω)
/850                   - –¢–µ—Å—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è 8:50 (–∞–¥–º–∏–Ω)
/920                   - –¢–µ—Å—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è 9:20 (–∞–¥–º–∏–Ω)
/935                   - –¢–µ—Å—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è 9:35 (–∞–¥–º–∏–Ω)
/950                   - –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —à—Ç—Ä–∞—Ñ–æ–≤ (–∞–¥–º–∏–Ω)
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **Supabase** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **OpenAI Whisper** - —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –≥–æ–ª–æ—Å–∞
- **n8n** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ AI
- **APScheduler** - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á

## üìä –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á–µ—Ç—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —á–∞—Ç:
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞—Å—Å—ã–ª–æ–∫
- –®—Ç—Ä–∞—Ñ—ã –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- –¢–∞–π–º–∞—É—Ç—ã n8n
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å–≤–æ–¥–∫–∞ (23:59)

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤

–í—Å–µ —Ç–µ–∫—Å—Ç—ã –±–æ—Ç–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `messages.py` –∏ `monitoring_messages.py`.
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTML-—Ç–µ–≥–∏: `<b>`, `<i>`, `<u>`, `<code>`, `<a>`.

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ `users` –≤ Supabase.
–ó–∞–¥–∞–Ω–∏—è –∫—É—Ä—Å–∞ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `digest_day_1` ... `digest_day_14`.

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º:
- –ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢.txt
- –ò–ù–°–¢–†–£–ö–¶–ò–Ø.md
- –ú–û–ù–ò–¢–û–†–ò–ù–ì.md

---

**–£–¥–∞—á–∏ —Å –∫—É—Ä—Å–æ–º "–†–∞–∑–≥–æ–Ω"! üöÄ**

